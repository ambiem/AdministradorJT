<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	>

<h:head>
	<h:outputStylesheet name="/css/theme.css" library="css" />
	<ui:include src="modales/modalCapturaEntrada.xhtml"/>
</h:head>

	<h:form>
		<h:body>
				<p:growl id="msgs" showDetail="true"/>
				<p:panel id="panelBusqueda" header="Busqueda" style="border: none;">
					<p:panelGrid columns="4" layout="grid" style="border: none;">
					
						<p:outputLabel for="concepto" value="Concepto:" />
						<p:inputText id="concepto" value="#{movimientoCteBean.conceptoB}"/>
		
						<p:outputLabel for="tipoMovimiento" value="Tipo Movimiento:" />
						<p:selectOneMenu id="tipoMovimiento" label="Tipo movimiento"  value="#{movimientoCteBean.tipoMovimientoB}" > 
							<f:selectItem itemLabel="Seleccione.."/> 
							<f:selectItem itemLabel="Abono" itemValue="1" />
							<f:selectItem itemLabel="Cargo" itemValue="2" />
						</p:selectOneMenu>
						
						<p:outputLabel for="fechaInicio" value="Fecha Inicio:" />
						<p:calendar id="fechaInicio" value="#{movimientoCteBean.fechaInicioB}" />
		
						<p:outputLabel for="fechaFin" value="Fecha Fin:" />
						<p:calendar id="fechaFin" value="#{movimientoCteBean.fechaFinB}" />
						
						<p:outputLabel for="clienteEntrada" value="Cliente" />
						<p:selectOneMenu id="clienteEntrada" value="#{movimientoCteBean.clienteB}"> 
							<f:selectItem itemLabel="Seleccione.."/> 
							<f:selectItems value="#{clienteBean.listaCliente}" var="cliente" itemLabel="#{cliente.nombre}" itemValue="#{cliente.idCliente}" /> 
						</p:selectOneMenu>	
						
					</p:panelGrid>
		
					<p:panelGrid columns="2" layout="grid"  style="border: none;  text-align:center;">
						<p:commandButton update="tablaMovimientos" value="Buscar" action="#{movimientoCteBean.buscar}"/>
						<p:commandButton update="tablaMovimientos" value="Buscar Todo" action="#{movimientoCteBean.buscarTodo}"/> 
					</p:panelGrid>
				</p:panel>
		
				<p:panel id="panelCaptura" header="Captura" style="border: none;">
					<p:panelGrid columns="1" layout="grid" style="border: none; text-align:center;">
						<p:commandButton value="Nueva Operacion" type="button" onclick="PF('modalCapturaMovimientoCte').show();" />
					</p:panelGrid>
				</p:panel>
		
				<p:dataTable id="tablaMovimientos" var="movimientos" value="#{movimientoCteBean.listaMovimientoCte}" editable="true" paginator="true"  rows="30"> 
					
					<p:ajax event="rowEdit" listener="#{movimientoCteBean.editar}" update="tablaMovimientos"/>
       				<p:ajax event="rowEditCancel" listener="#{movimientoCteBean.cancelarEdicion}" />  
       				
					<p:column headerText="Fecha">
						<p:cellEditor>
							<f:facet name="output"><h:outputText value="#{movimientos.fecha}" /></f:facet>
	               			<f:facet name="input">
	               				<p:calendar value="#{movimientos.fecha}" style="width:100%"/>
	               			</f:facet>
	               		</p:cellEditor>
					</p:column>
		
					<p:column headerText="Concepto">
						<p:cellEditor >
							<f:facet name="output"><h:outputText value="#{movimientos.concepto}" /></f:facet>
							<f:facet name="input">
								<p:inputText value="#{movimientos.concepto}"/>
							</f:facet>
						</p:cellEditor>
					</p:column>
					
					<p:column headerText="Cliente">
						<p:cellEditor>
						 	<f:facet name="output">
						 		<h:outputText  value="#{movimientos.nombreCliente}" />
						 	</f:facet>
						 	<f:facet name="input">
								<p:selectOneMenu value="#{movimientos.idCliente}">
									<f:selectItems value="#{clienteBean.listaCliente}" var="cliente" itemLabel="#{cliente.nombre}" itemValue="#{cliente.idCliente}" /> 
								</p:selectOneMenu>					 		
						 	</f:facet>
						 </p:cellEditor>
					</p:column>
		
					<p:column headerText="Abono">
							<p:cellEditor rendered="#{movimientos.tipoMovimiento == 1}">
								<f:facet name="output">
									<h:outputText value="#{movimientos.monto}" >
										<f:convertNumber pattern="¤#,##0.00" />
									</h:outputText>
								</f:facet>
								<f:facet name="input">
									<p:inputText value="#{movimientos.monto}"/>
								</f:facet>
							</p:cellEditor>
					</p:column>
		
					<p:column headerText="Cargo">
							<p:cellEditor rendered="#{movimientos.tipoMovimiento == 2}">
								<f:facet name="output">
									<h:outputText value="#{movimientos.monto}" >
										<f:convertNumber pattern="¤#,##0.00" />
									</h:outputText>
								</f:facet>
								<f:facet name="input">
									<p:inputText value="#{movimientos.monto}"/>
								</f:facet>
							</p:cellEditor>
					</p:column>
		
					<p:column headerText="Editar" style="width:50px;">
		 	           	<p:rowEditor />
					</p:column>
					<p:column headerText="Borrar" style="width:60px;">
		 	            	<p:commandButton update="tablaMovimientos" label="borrar" title="X" actionListener="#{movimientoCteBean.borrar(operaciones)}" >
			 	            	<p:confirm header="Confirmar borrar" message="¿Estas seguro de borrar?" icon="ui-icon-alert" />
							</p:commandButton>
							
							<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
						        <p:commandButton value="Si" styleClass="ui-confirmdialog-yes"/>
						        <p:commandButton value="No" styleClass="ui-confirmdialog-no"/>
						    </p:confirmDialog>
					</p:column>
		
				</p:dataTable>
		</h:body>
	</h:form>
</html>